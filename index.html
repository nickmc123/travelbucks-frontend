<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TravelBucks - Gamified Travel Rewards</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap');
        body { font-family: 'Inter', sans-serif; }
        .gradient-bg { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
        .card-hover { transition: transform 0.2s, box-shadow 0.2s; }
        .card-hover:hover { transform: translateY(-4px); box-shadow: 0 12px 24px rgba(0,0,0,0.15); }
        .game-card { background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); }
        .tier-free { background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%); }
        .tier-plus { background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%); }
        .tier-premium { background: linear-gradient(135deg, #ffd89b 0%, #19547b 100%); }
    </style>
</head>
<body class="bg-gray-50" x-data="travelBucksApp()">
    
    <!-- Navigation -->
    <nav class="gradient-bg text-white shadow-lg">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <div class="flex items-center space-x-2">
                    <svg class="w-8 h-8" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"/>
                    </svg>
                    <span class="text-2xl font-bold">TravelBucks</span>
                </div>
                <div class="flex space-x-6">
                    <button @click="currentView = 'dashboard'" :class="currentView === 'dashboard' ? 'font-bold' : ''" class="hover:text-purple-200">Dashboard</button>
                    <button @click="currentView = 'play'" :class="currentView === 'play' ? 'font-bold' : ''" class="hover:text-purple-200">Play</button>
                    <button @click="currentView = 'sweepstakes'" :class="currentView === 'sweepstakes' ? 'font-bold' : ''" class="hover:text-purple-200">Sweepstakes</button>
                    <button @click="currentView = 'book'" :class="currentView === 'book' ? 'font-bold' : ''" class="hover:text-purple-200">Book Travel</button>
                    <button @click="currentView = 'membership'" :class="currentView === 'membership' ? 'font-bold' : ''" class="hover:text-purple-200">Membership</button>
                </div>
                <div class="flex items-center space-x-4">
                    <div class="text-sm">
                        <div class="font-bold" x-text="user.travelbucks + ' TB'"></div>
                        <div class="text-xs text-purple-200">Balance</div>
                    </div>
                    <div class="w-10 h-10 bg-white rounded-full flex items-center justify-center text-purple-600 font-bold">
                        <span x-text="user.name[0]"></span>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Dashboard View -->
    <div x-show="currentView === 'dashboard'" class="max-w-7xl mx-auto px-4 py-8">
        <h1 class="text-4xl font-bold text-gray-800 mb-2">Welcome back, <span x-text="user.name"></span>! üëã</h1>
        <p class="text-gray-600 mb-8">You're on a <span class="font-semibold text-purple-600" x-text="user.tier"></span> plan</p>

        <!-- Stats Grid -->
        <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
            <div class="bg-white p-6 rounded-lg shadow card-hover">
                <div class="text-3xl mb-2">üí∞</div>
                <div class="text-2xl font-bold text-purple-600" x-text="user.travelbucks"></div>
                <div class="text-sm text-gray-600">TravelBucks</div>
            </div>
            <div class="bg-white p-6 rounded-lg shadow card-hover">
                <div class="text-3xl mb-2">‚≠ê</div>
                <div class="text-2xl font-bold text-blue-600" x-text="user.xp"></div>
                <div class="text-sm text-gray-600">Experience Points</div>
            </div>
            <div class="bg-white p-6 rounded-lg shadow card-hover">
                <div class="text-3xl mb-2">üéüÔ∏è</div>
                <div class="text-2xl font-bold text-green-600" x-text="user.sweepstakesEntries"></div>
                <div class="text-sm text-gray-600">Sweepstakes Entries</div>
            </div>
            <div class="bg-white p-6 rounded-lg shadow card-hover">
                <div class="text-3xl mb-2">‚úàÔ∏è</div>
                <div class="text-2xl font-bold text-orange-600" x-text="user.bookings"></div>
                <div class="text-sm text-gray-600">Trips Booked</div>
            </div>
        </div>

        <!-- Recent Activity -->
        <div class="bg-white rounded-lg shadow p-6 mb-8">
            <h2 class="text-2xl font-bold mb-4">Recent Activity</h2>
            <div class="space-y-4">
                <template x-for="activity in recentActivity" :key="activity.id">
                    <div class="flex items-center justify-between border-b pb-3">
                        <div class="flex items-center space-x-4">
                            <div class="text-2xl" x-text="activity.icon"></div>
                            <div>
                                <div class="font-semibold" x-text="activity.title"></div>
                                <div class="text-sm text-gray-500" x-text="activity.time"></div>
                            </div>
                        </div>
                        <div class="font-bold" :class="activity.amount > 0 ? 'text-green-600' : 'text-gray-600'">
                            <span x-text="activity.amount > 0 ? '+' + activity.amount : activity.amount"></span>
                            <span x-text="activity.currency"></span>
                        </div>
                    </div>
                </template>
            </div>
        </div>

        <!-- Quick Actions -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
            <button @click="currentView = 'play'" class="bg-gradient-to-r from-purple-500 to-pink-500 text-white p-6 rounded-lg shadow-lg hover:shadow-xl transform hover:scale-105 transition">
                <div class="text-4xl mb-2">üéÆ</div>
                <div class="text-xl font-bold">Play Games</div>
                <div class="text-sm opacity-90">Earn XP & TravelBucks</div>
            </button>
            <button @click="currentView = 'book'" class="bg-gradient-to-r from-blue-500 to-cyan-500 text-white p-6 rounded-lg shadow-lg hover:shadow-xl transform hover:scale-105 transition">
                <div class="text-4xl mb-2">‚úàÔ∏è</div>
                <div class="text-xl font-bold">Book Travel</div>
                <div class="text-sm opacity-90">Earn rewards on bookings</div>
            </button>
            <button @click="currentView = 'sweepstakes'" class="bg-gradient-to-r from-green-500 to-teal-500 text-white p-6 rounded-lg shadow-lg hover:shadow-xl transform hover:scale-105 transition">
                <div class="text-4xl mb-2">üéÅ</div>
                <div class="text-xl font-bold">Enter Sweepstakes</div>
                <div class="text-sm opacity-90">Win amazing prizes</div>
            </button>
        </div>
    </div>

    <!-- Play View -->
    <div x-show="currentView === 'play'" class="max-w-7xl mx-auto px-4 py-8">
        <h1 class="text-4xl font-bold text-gray-800 mb-2">Play & Earn üéÆ</h1>
        <p class="text-gray-600 mb-8">Play games to earn XP and TravelBucks!</p>

        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
            <template x-for="game in games" :key="game.id">
                <div class="bg-white rounded-lg shadow-lg overflow-hidden card-hover">
                    <div class="h-48 flex items-center justify-center text-6xl" :style="'background: ' + game.gradient">
                        <span x-text="game.icon"></span>
                    </div>
                    <div class="p-6">
                        <h3 class="text-xl font-bold mb-2" x-text="game.name"></h3>
                        <p class="text-gray-600 text-sm mb-4" x-text="game.description"></p>
                        <div class="flex justify-between items-center mb-4">
                            <div>
                                <div class="text-sm text-gray-500">Rewards</div>
                                <div class="font-bold text-purple-600" x-text="game.xpReward + ' XP'"></div>
                            </div>
                            <div>
                                <div class="text-sm text-gray-500">Cost</div>
                                <div class="font-bold text-orange-600" x-text="game.cost + ' TB'"></div>
                            </div>
                        </div>
                        <button @click="playGame(game)" class="w-full bg-gradient-to-r from-purple-500 to-pink-500 text-white py-3 rounded-lg font-semibold hover:shadow-lg transition">
                            Play Now
                        </button>
                    </div>
                </div>
            </template>
        </div>
    </div>

    <!-- Sweepstakes View -->
    <div x-show="currentView === 'sweepstakes'" class="max-w-7xl mx-auto px-4 py-8">
        <h1 class="text-4xl font-bold text-gray-800 mb-2">Active Sweepstakes üéÅ</h1>
        <p class="text-gray-600 mb-8">Enter for a chance to win amazing travel prizes!</p>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <template x-for="sweepstake in sweepstakes" :key="sweepstake.id">
                <div class="bg-white rounded-lg shadow-lg overflow-hidden">
                    <div class="h-48 bg-gradient-to-r from-yellow-400 to-orange-500 flex items-center justify-center text-white">
                        <div class="text-center">
                            <div class="text-6xl mb-2" x-text="sweepstake.icon"></div>
                            <div class="text-2xl font-bold" x-text="sweepstake.prize"></div>
                        </div>
                    </div>
                    <div class="p-6">
                        <h3 class="text-xl font-bold mb-2" x-text="sweepstake.name"></h3>
                        <p class="text-gray-600 text-sm mb-4" x-text="sweepstake.description"></p>
                        <div class="grid grid-cols-2 gap-4 mb-4">
                            <div>
                                <div class="text-sm text-gray-500">Entry Cost</div>
                                <div class="font-bold text-purple-600" x-text="sweepstake.entryCost + ' TB'"></div>
                            </div>
                            <div>
                                <div class="text-sm text-gray-500">Drawing Date</div>
                                <div class="font-bold text-gray-800" x-text="sweepstake.drawingDate"></div>
                            </div>
                        </div>
                        <div class="mb-4">
                            <div class="text-sm text-gray-500 mb-1">Your Entries: <span class="font-bold" x-text="sweepstake.yourEntries"></span></div>
                            <div class="w-full bg-gray-200 rounded-full h-2">
                                <div class="bg-green-500 h-2 rounded-full" :style="'width: ' + (sweepstake.yourEntries / sweepstake.maxEntries * 100) + '%'"></div>
                            </div>
                            <div class="text-xs text-gray-500 mt-1">Max entries: <span x-text="sweepstake.maxEntries"></span></div>
                        </div>
                        <button @click="enterSweepstake(sweepstake)" :disabled="sweepstake.yourEntries >= sweepstake.maxEntries" class="w-full bg-gradient-to-r from-green-500 to-teal-500 text-white py-3 rounded-lg font-semibold hover:shadow-lg transition disabled:opacity-50 disabled:cursor-not-allowed">
                            <span x-show="sweepstake.yourEntries < sweepstake.maxEntries">Enter Now</span>
                            <span x-show="sweepstake.yourEntries >= sweepstake.maxEntries">Max Entries Reached</span>
                        </button>
                        <p class="text-xs text-gray-500 mt-2 text-center">
                            <a href="#" class="underline">Official Rules</a> | 
                            <a href="#" class="underline">AMOE</a>
                        </p>
                    </div>
                </div>
            </template>
        </div>
    </div>

    <!-- Book Travel View -->
    <div x-show="currentView === 'book'" class="max-w-7xl mx-auto px-4 py-8">
        <h1 class="text-4xl font-bold text-gray-800 mb-2">Book Your Next Adventure ‚úàÔ∏è</h1>
        <p class="text-gray-600 mb-8">Earn TravelBucks and XP on every booking!</p>

        <div class="bg-white rounded-lg shadow-lg p-8 mb-8">
            <h2 class="text-2xl font-bold mb-6">Search Travel</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                <div>
                    <label class="block text-sm font-semibold mb-2">Destination</label>
                    <input type="text" placeholder="Where to?" class="w-full border rounded-lg px-4 py-3 focus:ring-2 focus:ring-purple-500 focus:border-transparent">
                </div>
                <div>
                    <label class="block text-sm font-semibold mb-2">Dates</label>
                    <input type="text" placeholder="When?" class="w-full border rounded-lg px-4 py-3 focus:ring-2 focus:ring-purple-500 focus:border-transparent">
                </div>
            </div>
            <button class="w-full bg-gradient-to-r from-purple-500 to-pink-500 text-white py-4 rounded-lg font-semibold text-lg hover:shadow-lg transition">
                Search Deals
            </button>
        </div>

        <h2 class="text-2xl font-bold mb-6">Featured Deals üî•</h2>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
            <template x-for="deal in travelDeals" :key="deal.id">
                <div class="bg-white rounded-lg shadow-lg overflow-hidden card-hover">
                    <div class="h-48 bg-gradient-to-br from-blue-400 to-purple-500 flex items-center justify-center text-white text-6xl">
                        <span x-text="deal.icon"></span>
                    </div>
                    <div class="p-6">
                        <h3 class="text-xl font-bold mb-2" x-text="deal.destination"></h3>
                        <p class="text-gray-600 text-sm mb-4" x-text="deal.description"></p>
                        <div class="flex justify-between items-center mb-4">
                            <div>
                                <div class="text-sm text-gray-500">From</div>
                                <div class="text-2xl font-bold text-purple-600" x-text="'$' + deal.price"></div>
                            </div>
                            <div class="text-right">
                                <div class="text-sm text-gray-500">Earn</div>
                                <div class="font-bold text-green-600" x-text="deal.reward + ' TB'"></div>
                            </div>
                        </div>
                        <button class="w-full bg-gradient-to-r from-blue-500 to-cyan-500 text-white py-3 rounded-lg font-semibold hover:shadow-lg transition">
                            View Details
                        </button>
                    </div>
                </div>
            </template>
        </div>
    </div>

    <!-- Membership View -->
    <div x-show="currentView === 'membership'" class="max-w-7xl mx-auto px-4 py-8">
        <h1 class="text-4xl font-bold text-gray-800 mb-2">Membership Tiers üëë</h1>
        <p class="text-gray-600 mb-8">Unlock more rewards and benefits!</p>

        <div class="grid grid-cols-1 md:grid-cols-3 gap-6" x-show="!loadingTiers">
            <template x-for="tier in membershipTiers" :key="tier.id">
                <div class="rounded-lg shadow-lg overflow-hidden card-hover" :class="tier.id === 1 ? 'tier-free' : tier.id === 2 ? 'tier-plus' : 'tier-premium'">
                    <div class="p-8 text-center">
                        <h3 class="text-2xl font-bold mb-2" x-text="tier.name"></h3>
                        <div class="text-4xl font-bold mb-4" x-text="tier.monthly_price_cents === 0 ? 'Free' : '$' + (tier.monthly_price_cents / 100)"></div>
                        <p class="text-sm mb-6" x-text="tier.monthly_price_cents === 0 ? 'Forever' : 'per month'"></p>
                        <button @click="upgradeTier(tier)" :disabled="user.tier === tier.name" class="w-full bg-white text-purple-600 py-3 rounded-lg font-semibold hover:shadow-lg transition disabled:opacity-50 disabled:cursor-not-allowed" :class="user.tier === tier.name ? 'ring-2 ring-green-500' : ''">
                            <span x-show="user.tier === tier.name">‚úì Current Plan</span>
                            <span x-show="user.tier !== tier.name">Select Plan</span>
                        </button>
                    </div>
                    <div class="bg-white bg-opacity-90 p-6">
                        <h4 class="font-bold mb-3">Features:</h4>
                        <ul class="space-y-2 text-sm">
                            <template x-for="feature in tier.features" :key="feature">
                                <li class="flex items-start">
                                    <span class="text-green-500 mr-2">‚úì</span>
                                    <span x-text="feature"></span>
                                </li>
                            </template>
                        </ul>
                    </div>
                </div>
            </template>
        </div>

        <div x-show="loadingTiers" class="text-center py-12">
            <div class="text-4xl mb-4">‚è≥</div>
            <div class="text-gray-600">Loading membership tiers...</div>
        </div>
    </div>

    <!-- Success Toast -->
    <div x-show="showToast" x-transition class="fixed bottom-4 right-4 bg-green-500 text-white px-6 py-4 rounded-lg shadow-lg flex items-center space-x-2">
        <span class="text-2xl">üéâ</span>
        <span x-text="toastMessage"></span>
    </div>

    <script>
        function travelBucksApp() {
            return {
                currentView: 'dashboard',
                showToast: false,
                toastMessage: '',
                loadingTiers: false,
                apiUrl: 'https://travelbucks-rewards-production.up.railway.app',
                
                user: {
                    name: 'Sarah',
                    tier: 'TravelBucks Plus',
                    travelbucks: 2450,
                    xp: 8750,
                    sweepstakesEntries: 15,
                    bookings: 3
                },

                recentActivity: [
                    { id: 1, icon: 'üéÆ', title: 'Played Spin the Globe', amount: 50, currency: 'XP', time: '2 hours ago' },
                    { id: 2, icon: '‚úàÔ∏è', title: 'Booked flight to Hawaii', amount: 500, currency: 'TB', time: '1 day ago' },
                    { id: 3, icon: 'üéÅ', title: 'Entered Grand Prize Draw', amount: -100, currency: 'TB', time: '2 days ago' },
                    { id: 4, icon: '‚≠ê', title: 'Reached Level 10', amount: 200, currency: 'TB', time: '3 days ago' }
                ],

                games: [
                    { id: 1, name: 'Spin the Globe', icon: 'üåç', description: 'Spin and discover destinations!', xpReward: 50, cost: 10, gradient: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)' },
                    { id: 2, name: 'Travel Trivia', icon: 'üß†', description: 'Test your travel knowledge', xpReward: 75, cost: 15, gradient: 'linear-gradient(135deg, #f093fb 0%, #f5576c 100%)' },
                    { id: 3, name: 'Destination Match', icon: 'üéØ', description: 'Match famous landmarks', xpReward: 60, cost: 12, gradient: 'linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)' },
                    { id: 4, name: 'Scratch & Win', icon: 'üí∞', description: 'Instant prizes!', xpReward: 100, cost: 20, gradient: 'linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%)' },
                    { id: 5, name: 'Lucky Luggage', icon: 'üé≤', description: 'Roll the dice!', xpReward: 80, cost: 15, gradient: 'linear-gradient(135deg, #a8edea 0%, #fed6e3 100%)' }
                ],

                sweepstakes: [
                    { id: 1, name: 'Hawaii Getaway', icon: 'üèùÔ∏è', prize: '$5,000 Trip', description: 'Win a luxury 7-night stay in Maui with flights included', entryCost: 100, drawingDate: 'Feb 15', yourEntries: 2, maxEntries: 10 },
                    { id: 2, name: 'Europe Adventure', icon: 'üóº', prize: '$10,000 Trip', description: 'Grand tour of Paris, Rome, and Barcelona', entryCost: 150, drawingDate: 'Mar 1', yourEntries: 1, maxEntries: 15 }
                ],

                travelDeals: [
                    { id: 1, destination: 'Cancun', icon: 'üèñÔ∏è', description: '5 nights all-inclusive resort', price: 899, reward: 450 },
                    { id: 2, destination: 'New York', icon: 'üóΩ', description: '4 nights + Broadway show', price: 699, reward: 350 },
                    { id: 3, destination: 'Dubai', icon: 'üïå', description: '7 nights luxury stay', price: 1599, reward: 800 }
                ],

                membershipTiers: [],

                init() {
                    this.loadMembershipTiers();
                },

                async loadMembershipTiers() {
                    this.loadingTiers = true;
                    try {
                        const response = await fetch(`${this.apiUrl}/api/v1/membership/tiers`);
                        if (response.ok) {
                            const data = await response.json();
                            this.membershipTiers = data.map(tier => ({
                                ...tier,
                                features: JSON.parse(tier.features || '[]')
                            }));
                        }
                    } catch (error) {
                        console.error('Error loading tiers:', error);
                        // Fallback data
                        this.membershipTiers = [
                            { id: 1, name: 'TravelBucks Go', monthly_price_cents: 0, features: ['Earn XP & TravelBucks', 'Access to all games', 'Basic sweepstakes entries'] },
                            { id: 2, name: 'TravelBucks Plus', monthly_price_cents: 999, features: ['Everything in Go', '2x XP multiplier', 'Exclusive sweepstakes', 'Priority booking'] },
                            { id: 3, name: 'TravelBucks Premium', monthly_price_cents: 1999, features: ['Everything in Plus', '3x XP multiplier', 'VIP sweepstakes', 'Concierge service', 'Free hotel upgrades'] }
                        ];
                    } finally {
                        this.loadingTiers = false;
                    }
                },

                playGame(game) {
                    if (this.user.travelbucks >= game.cost) {
                        this.user.travelbucks -= game.cost;
                        this.user.xp += game.xpReward;
                        this.toast(`You earned ${game.xpReward} XP!`);
                        this.recentActivity.unshift({
                            id: Date.now(),
                            icon: game.icon,
                            title: `Played ${game.name}`,
                            amount: game.xpReward,
                            currency: 'XP',
                            time: 'Just now'
                        });
                    } else {
                        this.toast('Not enough TravelBucks!');
                    }
                },

                enterSweepstake(sweepstake) {
                    if (sweepstake.yourEntries < sweepstake.maxEntries && this.user.travelbucks >= sweepstake.entryCost) {
                        this.user.travelbucks -= sweepstake.entryCost;
                        sweepstake.yourEntries++;
                        this.user.sweepstakesEntries++;
                        this.toast('Entry successful! Good luck! üçÄ');
                        this.recentActivity.unshift({
                            id: Date.now(),
                            icon: 'üéÅ',
                            title: `Entered ${sweepstake.name}`,
                            amount: -sweepstake.entryCost,
                            currency: 'TB',
                            time: 'Just now'
                        });
                    }
                },

                upgradeTier(tier) {
                    if (this.user.tier !== tier.name) {
                        this.user.tier = tier.name;
                        this.toast(`Upgraded to ${tier.name}!`);
                    }
                },

                toast(message) {
                    this.toastMessage = message;
                    this.showToast = true;
                    setTimeout(() => {
                        this.showToast = false;
                    }, 3000);
                }
            }
        }
    </script>
</body>
</html>
